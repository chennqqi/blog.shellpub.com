<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.25.1" />

  <title>SHELLPUB BLOG</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="http://blog.shellpub.com/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="http://blog.shellpub.com/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="http://blog.shellpub.com/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  
  <link rel="alternate" type="application/rss+xml" title="SHELLPUB BLOG" href="http://blog.shellpub.com/index.xml" />
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://blog.shellpub.com/img/favicon.ico" type="image/x-icon" />

  
    <link rel="stylesheet" href="http://blog.shellpub.com/css/custom.css">
  
  
    <script src="http://blog.shellpub.com/js/baidu.js"></script>
  
    <script src="http://blog.shellpub.com/js/baidupush.js"></script>
  
    <script src="http://blog.shellpub.com/js/cnzz.js"></script>
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  
  <a class="pure-menu-heading brand" href="http://blog.shellpub.com/">SHELLPUB</a>


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://blog.shellpub.com/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://blog.shellpub.com/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://blog.shellpub.com/contact/"><i class='fa fa-phone fa-fw'></i>Contact</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://n.shellpub.com"><i class='fa fa-chrome fa-fw'></i>在线查杀</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://www.shellpub.com"><i class='fa fa-globe fa-fw'></i>官网</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="http://blog.shellpub.com/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://blog.shellpub.com/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://weibo.com/chennqqi" target="_blank"><i class="fa fa-weibo fa-fw"></i>Weibo</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/webshellpub" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2017. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>SHELLPUB BLOG</h1>
  <h2>专注webshell查杀</h2>
</div>

<div class="content">
  
    <article>
  <header>
    <h2><a href="http://blog.shellpub.com/2017/08/05/asp_sort-code.html">Asp生成按照字段排序代码</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2017-08-05 11:01</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/asp">ASP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/iis">IIS</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/windows">Windows</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/asp">Asp</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/%E6%8E%92%E5%BA%8F">排序</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  //author :x@shellpub.com //website:www.shellpub.com function subject_sort_link(sod,sord,sst,flag,sType,svalue,nPage) q1 = &quot;sod=&quot; &amp; sod if flag = &quot;asc&quot; Then q2=&quot;sst=asc&quot; if sod=sord then if sst = &quot;asc&quot; then q2 = &quot;sst=desc&quot; end if end if else q2 = &quot;sst=desc&quot; if sod=sord then if sst = &quot;desc&quot; then q2 = &quot;sst=asc &quot; end if end if end if response.Write &quot;&lt;a href=list.asp?nPage=&quot; &amp; nPage &amp; &quot;&amp;sType=&quot; &amp; sType &amp; &quot;&amp;sValue=&quot;&amp;keyword&amp;&quot;&amp;&quot;&amp;q1&amp;&quot;&amp;&quot;&amp;q2&amp;&quot;&gt;&quot; end function 函数调用 可以生成连接 create_time 为排序的数据库字段 subject_sort_link(&quot;create_time&quot;,sod,sst,&quot;desc&quot;,sType,sValue,nPage) 在组装sql语句的时候,如果为空的时候，设置默认的排序规则。 if sst = &quot;&quot; Then sst = &quot; desc&quot; end if if sod &lt;&gt; &quot;&quot; Then sord = getDatabase(sod) &amp; &quot;.
  </p>

  
  <footer>
    <a href="http://blog.shellpub.com/2017/08/05/asp_sort-code.html">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://blog.shellpub.com/2017/08/03/asp_off-site-landing-warning.html">asp 限制多IP登录</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2017-08-03 10:01</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/asp">ASP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/iis">IIS</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/windows">Windows</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/ajax">Ajax</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/asp">Asp</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/login">Login</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/ip">IP</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/%E5%BC%82%E5%9C%B0%E7%99%BB%E9%99%86">异地登陆</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/ajax">Ajax</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  目的 限制同一账号多IP登录
原理  前端不断发送Ajax请求后端ASP，每隔几秒钟更新一次登陆请求。 后端记录登陆IP和最后登录时间。 如发现登录IP与最后登录IP不同，则登陆失败。 为了防止请求被缓存, 在请求中加随机数。 需要注意的是NAT环境下（网吧或者企业学校等公用出口）, 使用这个代码会导致其他用户登陆失败  代码 ajax_update.js
//author :x@shellpub.com //website:www.shellpub.com function makeRequest() { var guid = rnd(); //记住给个随机数，不然的话有缓存 var url = &quot;updateLogin.asp&quot;; createXMLHttpRequest(); xmlHttp.onreadystatechange = handleRefresh; xmlHttp.open(&quot;GET&quot;, url, false); xmlHttp.send(null); } //创建xmlHttp var xmlHttp; function createXMLHttpRequest() { if (window.ActiveXObject) { xmlHttp = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;); } else if (window.XMLHttpRequest) { xmlHttp = new XMLHttpRequest(); } } //返回信息 function handleRefresh() { if (xmlHttp.readyState == 4) { if (xmlHttp.
  </p>

  
  <footer>
    <a href="http://blog.shellpub.com/2017/08/03/asp_off-site-landing-warning.html">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://blog.shellpub.com/2017/07/13/domainblock_alert.html">更换域名 紧急通告</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2017-07-13 15:31</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/alarm">alarm</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/%E5%85%AC%E5%91%8A">公告</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  紧急公告 http://webhsell.pub 后门查杀，域名无法在国内备案（管局不支持.PUB）,现已准备全面迁移到http://shellpub.com
更新 2017-07-13 17:00 云查杀功能 已经恢复
目前已经恢复全部功能，有任何问题欢迎随时反馈
2017-07-13 15:40
经过技术人员的紧急抢修目前http://n.webshell.pub已经恢复
已使用国外CDN通过301跳转到http://n.shellpub.com
部分地区可能需要等本地DNS更新，一般在24小时之内完成
云查杀功能还在紧急抢修当中
影响范围: 部分地区无法打开 n.webshell.pub 在线查杀
河马扫描器云查杀功能无法使用
导致有部分漏报  http://www.webshell.pub 使用国外CDN，不受影响
  </p>

  
</article>

  
    <article>
  <header>
    <h2><a href="http://blog.shellpub.com/2017/05/03/wordpress_core_remote_code_excute.html">漏洞预警-WordPress Core远程代码执行</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2017-05-03 13:46</time>
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/wordpress">wordpress</a>&nbsp;&#47;
    
      <a class="post-taxonomy-topic" href="http://blog.shellpub.com/topics/remote-code-excute">remote code excute</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/wordpress">wordpress</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="http://blog.shellpub.com/tags/%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6">漏洞预警</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  漏洞预警-WordPress Core远程代码执行(无需验证和插件) 
2017年5月1日，WordPress 4.6版本被曝出远程代码执行（RCE）漏洞，国外legalhackers发布该漏洞利用视频，从被曝出的视频中可以看到该漏洞在不需要验证，同时不需要安装任何插件即可获取反弹的shell。北京时间2017年5月4日，legalhackers发布了相关漏洞利用代码。
WordPress是一款由PHP语言开发的内容管理系统（CMS）系统。是当今最流行的cms，很适合二次开发，使用量超过百万。潜在影响范围广泛，请大家在官方补丁出来之前，提早做好防范。以免带来不必要的麻烦。
 google搜索Wordpress的结果 
我们将持续关注此漏洞
漏洞详情与PoC 该漏洞主要是由于使用了存在漏洞的PHPMailer，导致存在远程代码执行漏洞。
#!/bin/bash # # __ __ __ __ __ # / / ___ ____ _____ _/ / / / / /___ ______/ /_____ __________ # / / / _ \/ __ `/ __ `/ / / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/ # / /___/ __/ /_/ / /_/ / / / __ / /_/ / /__/ ,&lt; / __/ / (__ ) # /_____/\___/\__, /\__,_/_/ /_/ /_/\__,_/\___/_/|_|\___/_/ /____/ # /____/ # # # WordPress 4.
  </p>

  
  <footer>
    <a href="http://blog.shellpub.com/2017/05/03/wordpress_core_remote_code_excute.html">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

  
    <article>
  <header>
    <h2><a href="http://blog.shellpub.com/post/1/">1</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>2017-03-19 10:44</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  ##webshell.pub 第一篇博文
#关于我们 WEBSHELL.PUB
团队成员来自国内顶尖安全团队，专注webshell查杀研究。拥有海量webshell样本和自主查杀技术，采用传统特征+云端大数据双引擎的查杀技术。查杀速度快、精度高、误报低。
  </p>

  
</article>

  

  


</div>

</div>
</div>
<script src="http://blog.shellpub.com/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'Your Google Analytics tracking ID', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

